<!-- Row principal: resumen + asistencia por materia -->
<div class="row g-3 mb-4">
    <!-- Resumen general -->
    <div class="col-12 col-lg-4">
        <div class="card h-100 rounded shadow-sm">
            <div class="card-body">
                <h5 class="card-title mb-3">
                    <i class="bi bi-speedometer2 me-2"></i>
                    Resumen general
                </h5>

                <div class="row text-center">
                    <div class="col-4">
                        <p class="text-muted mb-1 small">Materias</p>
                        <p class="fs-4 fw-bold mb-0">{{ materiasActivas.length }}</p>
                    </div>
                    <div class="col-4 border-start border-end">
                        <p class="text-muted mb-1 small">Asistencia</p>
                        <p class="fs-4 fw-bold mb-0">{{ asistenciaGeneral }}%</p>
                    </div>
                    <div class="col-4">
                        <p class="text-muted mb-1 small">Faltas mes</p>
                        <p class="fs-4 fw-bold mb-0">{{ faltasMes }}</p>
                    </div>
                </div>

                <hr>

                <p class="mb-1 text-muted small">Progreso general</p>
                <div class="progress" role="progressbar" aria-label="Asistencia general"
                    [attr.aria-valuenow]="asistenciaGeneral" aria-valuemin="0" aria-valuemax="100">
                    <div class="progress-bar" [style.width.%]="asistenciaGeneral">
                        {{ asistenciaGeneral }}%
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Asistencia por materia (tabla + barra) -->
    <div class="col-12 col-lg-8">
        <div class="card h-100 rounded shadow-sm">
            <div class="card-body">
                <h5 class="card-title mb-3">
                    <i class="bi bi-graph-up-arrow me-2"></i>
                    Asistencia por materia
                </h5>

                <div *ngIf="resumenMaterias.length; else sinMaterias">
                    <div class="table-responsive">
                        <table class="table align-middle mb-0">
                            <thead class="table-light">
                                <tr>
                                    <th>Materia</th>
                                    <th>Comisi칩n</th>
                                    <th class="text-center">Asistencia</th>
                                    <th style="width: 40%;">Progreso</th>
                                    <th class="text-center">Acciones</th> <!-- 游녣 nueva columna -->
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let materia of resumenMaterias">
                                    <td>{{ materia.nombre }}</td>
                                    <td>{{ materia.comision }}</td>
                                    <td class="text-center">
                                        <span class="badge text-bg-success">
                                            {{ materia.asistencia }}%
                                        </span>
                                    </td>
                                    <td>
                                        <div class="progress" style="height: 0.8rem;">
                                            <div class="progress-bar" [ngClass]="{
                                            'bg-success': materia.asistencia >= 85,
                                            'bg-warning': materia.asistencia < 85 && materia.asistencia >= 70,
                                            'bg-danger': materia.asistencia < 70
                                            }" [style.width.%]="materia.asistencia">
                                            </div>
                                        </div>
                                    </td>
                                    <td class="text-center">
                                        <button type="button" class="btn btn-sm btn-outline-primary"
                                            (click)="verDetalleMateria(materia.nombre)">
                                            Ver detalle
                                        </button>
                                    </td>
                                </tr>
                            </tbody>

                        </table>
                    </div>
                    <p class="text-muted small mt-2">
                        * Asistencia calculada seg칰n las clases registradas en el sistema.
                    </p>
                </div>

                <ng-template #sinMaterias>
                    <p class="text-muted mb-0">
                        Todav칤a no ten칠s materias con asistencias registradas.
                    </p>
                </ng-template>
            </div>
        </div>
    </div>


</div>

<!-- Row: notificaciones + accesos r치pidos -->
<div class="row g-3">
    <!-- Notificaciones -->
    <div class="col-12 col-xl-6">
        <div class="card h-100 rounded shadow-sm">
            <div class="card-body">
                <h5 class="card-title mb-3">
                    <span class="badge text-bg-dark user-select-none me-2">
                        <i class="bi bi-bell-fill"></i>
                        3
                    </span>
                    Notificaciones recientes
                </h5>
                <ul class="list-unstyled mb-0">
                    <li class="mb-2">
                        <i class="bi bi-calendar-event text-primary me-2"></i>
                        <strong>Examen:</strong> Ten칠s un examen el 5 de agosto.
                    </li>
                    <li class="mb-2">
                        <i class="bi bi-exclamation-triangle text-warning me-2"></i>
                        <strong>Asistencia:</strong> Faltaste a Clases de Matem치tica el martes.
                    </li>
                    <li>
                        <i class="bi bi-check-circle-fill text-success me-2"></i>
                        <strong>Justificaci칩n:</strong> Tu justificaci칩n fue aprobada.
                    </li>
                </ul>
            </div>
        </div>
    </div>

    <!-- Accesos r치pidos -->
    <div class="col-12 col-xl-6">
        <div class="row g-3">
            <div class="col-12 col-md-4">
                <a routerLink="/private/student/subjects" class="text-decoration-none">
                    <div class="card dashboard-btn h-100 rounded shadow-sm">
                        <div class="card-body d-flex flex-column">
                            <h5 class="card-title mb-2">
                                <i class="bi bi-journal-bookmark me-2"></i>
                                Mis materias
                            </h5>
                            <p class="mb-0 small text-muted">
                                Consult치 tus materias activas, profesores y horarios.
                            </p>
                        </div>
                    </div>
                </a>
            </div>

            <div class="col-12 col-md-4">
                <a routerLink="/private/student/attendance-history" class="text-decoration-none">
                    <div class="card dashboard-btn h-100 rounded shadow-sm">
                        <div class="card-body d-flex flex-column">
                            <h5 class="card-title mb-2">
                                <i class="bi bi-clipboard2-check me-2"></i>
                                Mis asistencias
                            </h5>
                            <p class="mb-0 small text-muted">
                                Visualiz치 tu historial de asistencias por materia.
                            </p>
                        </div>
                    </div>
                </a>
            </div>

            <div class="col-12 col-md-4">
                <a routerLink="/private/student/justify-absence" class="text-decoration-none">
                    <div class="card dashboard-btn h-100 rounded shadow-sm">
                        <div class="card-body d-flex flex-column">
                            <h5 class="card-title mb-2">
                                <i class="bi bi-envelope-open me-2"></i>
                                Justificar faltas
                            </h5>
                            <p class="mb-0 small text-muted">
                                Envi치 tus justificativos por inasistencia desde aqu칤.
                            </p>
                        </div>
                    </div>
                </a>
            </div>
        </div>
    </div>
</div>